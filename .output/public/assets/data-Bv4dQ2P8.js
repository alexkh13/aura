import{c as j,u as E,r as o,a as I,j as e,l as m}from"./main-DwSGQJQP.js";import{a as C,u as O,c as A,d as R}from"./useData-CfHr73R5.js";import{C as P}from"./chevron-left-BaNQVTVO.js";import{U as z}from"./upload-D90mfJVC.js";import{T as M}from"./trash-2-DjgZj84f.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],J=j("download",F);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],B=j("triangle-alert",_);function V(){const k=E(),d=o.useRef(null),{activeProfile:L}=I(),[g,f]=o.useState(!1),[h,p]=o.useState(!1),[w,c]=o.useState(!1),{data:y}=C(),{data:x}=O(),{data:u}=A(),{data:b}=R(),N=async()=>{try{f(!0);const a=await m(),n={version:"1.0",exportDate:new Date().toISOString(),profiles:await a.profiles.find().exec().then(t=>t.map(s=>s.toJSON())),items:await a.items.find().exec().then(t=>t.map(s=>s.toJSON())),outfits:await a.outfits.find().exec().then(t=>t.map(s=>s.toJSON())),calendarEntries:await a.calendar_entries.find().exec().then(t=>t.map(s=>s.toJSON()))},i=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),r=URL.createObjectURL(i),l=document.createElement("a");l.href=r,l.download=`aura-wardrobe-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r),alert("Data exported successfully!")}catch(a){console.error("Export failed:",a),alert("Failed to export data. Please try again.")}finally{f(!1)}},v=async a=>{const n=a.target.files?.[0];if(n)try{p(!0);const i=await n.text(),r=JSON.parse(i);if(!r.version||!r.profiles||!r.items||!r.outfits)throw new Error("Invalid backup file format");const l=await m();for(const t of r.profiles)try{await l.profiles.upsert(t)}catch(s){console.warn("Failed to import profile:",t.id,s)}for(const t of r.items)try{await l.items.upsert(t)}catch(s){console.warn("Failed to import item:",t.id,s)}for(const t of r.outfits)try{await l.outfits.upsert(t)}catch(s){console.warn("Failed to import outfit:",t.id,s)}if(r.calendarEntries)for(const t of r.calendarEntries)try{await l.calendar_entries.upsert(t)}catch(s){console.warn("Failed to import calendar entry:",t.id,s)}alert("Data imported successfully!"),window.location.reload()}catch(i){console.error("Import failed:",i),alert("Failed to import data. Please check the file and try again.")}finally{p(!1),d.current&&(d.current.value="")}},D=async()=>{try{const a=await m(),n=await a.items.find().exec();for(const t of n)await t.remove();const i=await a.outfits.find().exec();for(const t of i)await t.remove();const r=await a.calendar_entries.find().exec();for(const t of r)await t.remove();const l=await a.profiles.find().exec();for(const t of l)await t.remove();localStorage.clear(),alert("All data has been deleted."),c(!1),window.location.href="/"}catch(a){console.error("Delete failed:",a),alert("Failed to delete all data. Please try again.")}},S=()=>`~${((x?.reduce((i,r)=>i+(r.photo?.length||0),0)||0)/(1024*1024)).toFixed(2)} MB`;return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pb-20",children:[e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("div",{className:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 px-4 py-4 sticky top-16 z-10",children:e.jsxs("button",{onClick:()=>k({to:"/settings"}),className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 font-medium",children:[e.jsx(P,{className:"w-5 h-5"}),"Data Management"]})}),e.jsxs("div",{className:"px-4 py-6 space-y-6",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3 px-2",children:"Storage Statistics"}),e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-800 overflow-hidden",children:e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Profiles"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:y?.length||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Items"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:x?.length||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Outfits"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:u?.length||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Calendar Entries"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:b?.length||0})]}),e.jsx("div",{className:"pt-3 border-t border-gray-100 dark:border-gray-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Estimated Size"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:S()})]})})]})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3 px-2",children:"Backup & Restore"}),e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-800 overflow-hidden",children:[e.jsxs("button",{onClick:N,disabled:g,className:"w-full flex items-center gap-4 p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors border-b border-gray-100 dark:border-gray-800 disabled:opacity-50",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-50 dark:bg-blue-950 rounded-lg flex items-center justify-center",children:e.jsx(J,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"font-medium text-gray-800 dark:text-gray-200",children:g?"Exporting...":"Export Data"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Download all your data as JSON"})]})]}),e.jsxs("button",{onClick:()=>d.current?.click(),disabled:h,className:"w-full flex items-center gap-4 p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors disabled:opacity-50",children:[e.jsx("div",{className:"w-10 h-10 bg-green-50 dark:bg-green-950 rounded-lg flex items-center justify-center",children:e.jsx(z,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"font-medium text-gray-800 dark:text-gray-200",children:h?"Importing...":"Import Data"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Restore from backup file"})]})]}),e.jsx("input",{ref:d,type:"file",accept:".json",onChange:v,className:"hidden"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm font-semibold text-red-500 dark:text-red-400 uppercase tracking-wide mb-3 px-2",children:"Danger Zone"}),e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-sm border border-red-200 dark:border-red-800 overflow-hidden",children:e.jsxs("button",{onClick:()=>c(!0),className:"w-full flex items-center gap-4 p-4 hover:bg-red-50 dark:hover:bg-red-950 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 bg-red-50 dark:bg-red-950 rounded-lg flex items-center justify-center",children:e.jsx(M,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"font-medium text-red-600 dark:text-red-400",children:"Delete All Data"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Permanently delete everything"})]})]})})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("span",{className:"font-semibold",children:"Backup Recommended:"})," Regular backups help protect your wardrobe data. Export your data periodically to keep it safe."]})})]})]}),w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-xl max-w-md w-full p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-950 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(B,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Delete All Data?"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"This will permanently delete:"}),e.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:["All profiles (",y?.length||0,")"]}),e.jsxs("li",{children:["All items (",x?.length||0,")"]}),e.jsxs("li",{children:["All outfits (",u?.length||0,")"]}),e.jsxs("li",{children:["All calendar entries (",b?.length||0,")"]}),e.jsx("li",{children:"All settings and preferences"})]}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 font-semibold mt-3",children:"This action cannot be undone!"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{onClick:()=>c(!1),className:"flex-1 py-3 px-4 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-lg font-medium hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:D,className:"flex-1 py-3 px-4 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors",children:"Delete Everything"})]})]})})]})}export{V as component};
