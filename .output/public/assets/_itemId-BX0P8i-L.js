import{u as I,R as E,r as d,j as e,S,L as u}from"./main-DwSGQJQP.js";import{f as z,c as L,u as O,g as D,h as A}from"./useData-CfHr73R5.js";import{O as T}from"./OutfitThumbnail-DbX7iLcp.js";import{C as B}from"./chevron-left-BaNQVTVO.js";import{X as F}from"./x-ev_B8KbH.js";import{C as M}from"./check-B7ifIDri.js";import{S as P,E as R}from"./square-pen-BMTE93WH.js";import{T as U}from"./trash-2-DjgZj84f.js";function H(){const n=I(),{itemId:l}=E.useParams(),{data:r,isLoading:y,error:h}=z(l),{data:p}=L(),{data:f,isLoading:j}=O(),i=D(),k=A(),[c,g]=d.useState(!1),[o,x]=d.useState(!1),[t,s]=d.useState({name:"",category:"",color:"",size:"",brand:"",tags:"",notes:""}),m=d.useRef(null);d.useEffect(()=>{r&&s({name:r.name||"",category:r.category||"",color:r.color||"",size:r.size||"",brand:r.brand||"",tags:r.tags||"",notes:r.notes||""})},[r]),d.useEffect(()=>{function a(C){m.current&&!m.current.contains(C.target)&&x(!1)}if(o)return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[o]);const v=async()=>{try{await i.mutateAsync({id:l,data:t}),g(!1)}catch(a){console.error("Failed to update item:",a),alert("Failed to update item")}},N=()=>{r&&s({name:r.name||"",category:r.category||"",color:r.color||"",size:r.size||"",brand:r.brand||"",tags:r.tags||"",notes:r.notes||""}),g(!1)},w=async()=>{if(confirm("Are you sure you want to delete this item? This action cannot be undone."))try{await k.mutateAsync(l),n({to:"/wardrobe"})}catch(a){console.error("Failed to delete item:",a),alert("Failed to delete item")}},b=p?.filter(a=>a.itemIds.includes(l))||[];return y?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading item..."})]})}):h||!r?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600 dark:text-red-400",children:"Item not found"}),e.jsx("button",{onClick:()=>n({to:"/wardrobe"}),className:"mt-4 text-blue-600 dark:text-blue-400 hover:underline",children:"Back to Wardrobe"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pb-20",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("div",{className:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 px-4 py-4 sticky top-16 z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>n({to:"/wardrobe"}),className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 font-medium",children:[e.jsx(B,{className:"w-5 h-5"}),c?"Editing Item":"Item Details"]}),e.jsx("div",{className:"flex items-center gap-2",children:c?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:N,disabled:i.isPending,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors disabled:opacity-50",title:"Cancel",children:e.jsx(F,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsx("button",{onClick:v,disabled:i.isPending,className:"p-2 hover:bg-green-100 dark:hover:bg-green-900 rounded-lg transition-colors disabled:opacity-50",title:"Save",children:e.jsx(M,{className:"w-5 h-5 text-green-600 dark:text-green-400"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>g(!0),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",title:"Edit",children:e.jsx(P,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{className:"relative",ref:m,children:[e.jsx("button",{onClick:()=>x(!o),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",title:"More options",children:e.jsx(R,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),o&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-20",children:e.jsxs("button",{onClick:()=>{x(!1),w()},className:"w-full px-4 py-2 text-left text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"Delete Item"]})})]})]})})]})}),e.jsxs("div",{className:"px-4 py-6 space-y-6",children:[e.jsx("section",{className:"bg-white dark:bg-gray-900 rounded-2xl overflow-hidden shadow-sm border border-gray-200 dark:border-gray-800",children:r.photo?e.jsxs("div",{className:"relative w-full",children:[e.jsx("img",{src:r.photo,alt:r.name,className:"w-full h-96 object-cover"}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-4",children:[e.jsx("p",{className:"text-white font-semibold text-lg",children:r.name}),e.jsx("p",{className:"text-white/90 text-sm",children:r.category})]})]}):e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950 dark:to-indigo-950 rounded-2xl p-12 border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[e.jsx(S,{className:"w-20 h-20 text-blue-400 dark:text-blue-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-semibold text-blue-700 dark:text-blue-400",children:r.name}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-500",children:r.category})]})]})})}),e.jsx("section",{className:"bg-white dark:bg-gray-900 rounded-2xl p-6 shadow-sm border border-gray-200 dark:border-gray-800",children:c?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Item Name *"}),e.jsx("input",{type:"text",value:t.name,onChange:a=>s({...t,name:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Blue Denim Jacket"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category *"}),e.jsxs("select",{value:t.category,onChange:a=>s({...t,category:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"Top",children:"Top"}),e.jsx("option",{value:"Bottom",children:"Bottom"}),e.jsx("option",{value:"Dress",children:"Dress"}),e.jsx("option",{value:"Outerwear",children:"Outerwear"}),e.jsx("option",{value:"Shoes",children:"Shoes"}),e.jsx("option",{value:"Accessories",children:"Accessories"}),e.jsx("option",{value:"Activewear",children:"Activewear"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Color"}),e.jsx("input",{type:"text",value:t.color,onChange:a=>s({...t,color:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Blue"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Size"}),e.jsx("input",{type:"text",value:t.size,onChange:a=>s({...t,size:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., M, L, XL"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Brand"}),e.jsx("input",{type:"text",value:t.brand,onChange:a=>s({...t,brand:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Nike, Zara"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tags"}),e.jsx("input",{type:"text",value:t.tags,onChange:a=>s({...t,tags:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., #casual #summer"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes"}),e.jsx("textarea",{value:t.notes,onChange:a=>s({...t,notes:a.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Additional notes about this item..."})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100 mb-4",children:r.name}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100 dark:border-gray-800",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Category:"}),e.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-100",children:r.category})]}),r.color&&e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100 dark:border-gray-800",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Color:"}),e.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-100",children:r.color})]}),r.size&&e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100 dark:border-gray-800",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Size:"}),e.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-100",children:r.size})]}),r.brand&&e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100 dark:border-gray-800",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Brand:"}),e.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-100",children:r.brand})]}),r.tags&&e.jsx("div",{className:"py-2",children:e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["Tags: ",r.tags]})})]}),r.notes&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-800",children:[e.jsx("h3",{className:"text-gray-600 dark:text-gray-400 mb-2",children:"Notes:"}),e.jsx("div",{className:"min-h-[60px] bg-gray-50 dark:bg-gray-800 rounded-lg p-3 text-gray-700 dark:text-gray-300 text-sm",children:r.notes})]})]})}),b.length>0&&e.jsxs("section",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:["Used in Outfits (",b.length,")"]}),e.jsx(u,{to:"/outfits",className:"text-blue-600 dark:text-blue-400 text-sm font-medium hover:text-blue-700 dark:hover:text-blue-500",children:"View All Outfits"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:b.map(a=>e.jsxs(u,{to:"/outfits/$outfitId",params:{outfitId:a.id},className:"bg-white dark:bg-gray-900 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-800 hover:border-blue-300 dark:hover:border-blue-700 transition-colors",children:[e.jsx(T,{itemIds:a.itemIds,items:f,size:"small",className:"mb-3",loading:j}),e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 text-center truncate",children:a.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 text-center truncate",children:a.season})]},a.id))})]})]})]})})}export{H as component};
